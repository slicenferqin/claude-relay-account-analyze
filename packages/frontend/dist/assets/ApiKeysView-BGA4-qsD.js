import{_ as se}from"./_plugin-vue_export-helper-BJA4NJ9J.js";/* empty css                 *//* empty css                   *//* empty css                        *//* empty css                    *//* empty css               */import{f as V,a as w,b as oe}from"./format-D-4OaA4K.js";/* empty css                *//* empty css                  *//* empty css                  */import{l as ne,r as T,c as ie,e as de,J as ue,m as h,q as p,t as i,H as e,B as t,u as s,G as F,Y as $,F as d,C as re,A as g,D as P,L as Y}from"./vue-vendor-W4Nd8ENd.js";import{au as ce,a8 as pe,a7 as _e,av as me,aj as fe,al as ve,S as ye,ah as ge,ai as be,aw as he,ax as Ae,ak as ke,a1 as o,W as Ce,Y as we,an as Ie,ap as Ee,ay as xe,az as Ve,aA as Ke,a5 as De,a4 as Te,at as Pe,as as Se,p as Le,aB as Re,aC as ze,aD as Ue}from"./element-plus-Oupk7keL.js";import{u as Be,a as Ge}from"./index-B15g6QvD.js";import{d as Me}from"./utils-7pt7gmow.js";const qe={class:"api-keys-view"},Ne={class:"header-actions"},Fe={class:"filters"},$e={class:"actions"},Ye={class:"stats-cards"},je={class:"stat-card"},He={class:"stat-value"},Je={class:"stat-card"},Oe={class:"stat-value"},We={class:"stat-card"},Qe={class:"stat-value"},Xe={class:"stat-card"},Ze={class:"stat-value"},et={class:"card-header"},tt={class:"api-key-name"},at={key:0,class:"tags"},lt={class:"rpm-display"},st={class:"rpm-text"},ot={key:0,class:"api-key-details"},nt={key:1},it=ne({__name:"ApiKeysView",setup(dt){const m=Be(),S=Ge(),c=T({groupId:"",isActive:!0,search:""}),K=T(!1),r=T(null),L=ie(()=>{let n=m.apiKeys;if(c.value.groupId&&(n=n.filter(l=>{var _;return((_=l.currentGroup)==null?void 0:_.id)===c.value.groupId})),c.value.isActive!==void 0&&(n=n.filter(l=>l.isActive===c.value.isActive)),c.value.search){const l=c.value.search.toLowerCase();n=n.filter(_=>{var A;return _.name.toLowerCase().includes(l)||((A=_.description)==null?void 0:A.toLowerCase().includes(l))||_.keyId.toLowerCase().includes(l)})}return n}),D=()=>{m.updateApiKeyFilters({groupId:c.value.groupId||void 0,isActive:c.value.isActive,search:c.value.search||void 0})},j=Me(()=>{D()},500),R=async()=>{await m.fetchApiKeys()},H=()=>{console.log("Export API Keys data")},z=n=>{r.value=n,K.value=!0,S.subscribeToApiKey(n.keyId)},J=n=>{console.log("Show usage chart for",n.name)},O=n=>Math.min(n/100*100,100),W=n=>n<10?"#67c23a":n<50?"#e6a23c":"#f56c6c",Q=n=>n>50?"high-cost":n>20?"medium-cost":"low-cost";return de(()=>{R()}),ue(()=>{m.apiKeys.forEach(n=>{S.unsubscribe("apikey",n.keyId)})}),(n,l)=>{var M;const _=be,A=ge,X=he,U=ce,I=_e,E=Ce,k=ve,b=ke,B=fe,x=De,C=Se,y=Ke,Z=Te,ee=Pe,te=Ue,v=ze,G=Re,ae=ye,le=Ve;return p(),h("div",qe,[i("div",Ne,[i("div",Fe,[e(U,null,{default:t(()=>[e(A,{modelValue:c.value.groupId,"onUpdate:modelValue":l[0]||(l[0]=a=>c.value.groupId=a),placeholder:"选择分组",clearable:"",onChange:D},{default:t(()=>[e(_,{label:"全部分组",value:""}),(p(!0),h(F,null,$(s(m).groups,a=>(p(),g(_,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e(A,{modelValue:c.value.isActive,"onUpdate:modelValue":l[1]||(l[1]=a=>c.value.isActive=a),placeholder:"状态",onChange:D},{default:t(()=>[e(_,{label:"全部状态",value:void 0}),e(_,{label:"活跃",value:!0}),e(_,{label:"非活跃",value:!1})]),_:1},8,["modelValue"]),e(X,{modelValue:c.value.search,"onUpdate:modelValue":l[2]||(l[2]=a=>c.value.search=a),placeholder:"搜索API Key","prefix-icon":s(Ae),clearable:"",onInput:s(j),style:{width:"200px"}},null,8,["modelValue","prefix-icon","onInput"])]),_:1})]),i("div",$e,[e(I,{type:"primary",icon:s(pe),loading:s(m).loading,onClick:R},{default:t(()=>[...l[4]||(l[4]=[d(" 刷新 ",-1)])]),_:1},8,["icon","loading"]),e(I,{icon:s(me),onClick:H},{default:t(()=>[...l[5]||(l[5]=[d(" 导出 ",-1)])]),_:1},8,["icon"])])]),i("div",Ye,[e(B,{gutter:16},{default:t(()=>[e(b,{span:6},{default:t(()=>[e(k,null,{default:t(()=>[i("div",je,[i("div",He,o(s(m).activeApiKeys.length),1),l[6]||(l[6]=i("div",{class:"stat-label"},"活跃API Keys",-1)),e(E,{class:"stat-icon"},{default:t(()=>[e(s(we))]),_:1})])]),_:1})]),_:1}),e(b,{span:6},{default:t(()=>[e(k,null,{default:t(()=>[i("div",Je,[i("div",Oe,o(s(V)(s(m).totalDailyCost)),1),l[7]||(l[7]=i("div",{class:"stat-label"},"今日总消费",-1)),e(E,{class:"stat-icon"},{default:t(()=>[e(s(Ie))]),_:1})])]),_:1})]),_:1}),e(b,{span:6},{default:t(()=>[e(k,null,{default:t(()=>[i("div",We,[i("div",Qe,o(s(w)(s(m).totalTodayRequests)),1),l[8]||(l[8]=i("div",{class:"stat-label"},"今日总请求",-1)),e(E,{class:"stat-icon"},{default:t(()=>[e(s(Ee))]),_:1})])]),_:1})]),_:1}),e(b,{span:6},{default:t(()=>[e(k,null,{default:t(()=>[i("div",Xe,[i("div",Ze,o(s(m).averageRPM),1),l[9]||(l[9]=i("div",{class:"stat-label"},"平均RPM",-1)),e(E,{class:"stat-icon"},{default:t(()=>[e(s(xe))]),_:1})])]),_:1})]),_:1})]),_:1})]),e(k,null,{header:t(()=>[i("div",et,[l[10]||(l[10]=i("span",null,"API Key 列表",-1)),e(x,{type:"info",size:"small"},{default:t(()=>[d(" 共 "+o(L.value.length)+" 个API Key ",1)]),_:1})])]),default:t(()=>[re((p(),g(te,{data:L.value,stripe:"",height:"600",onRowClick:z},{default:t(()=>[e(y,{prop:"name",label:"API Key名称",width:"200"},{default:t(({row:a})=>{var u;return[i("div",tt,[e(x,{strong:""},{default:t(()=>[d(o(a.name),1)]),_:2},1024),(u=a.tags)!=null&&u.length?(p(),h("div",at,[(p(!0),h(F,null,$(a.tags.slice(0,2),f=>(p(),g(C,{key:f,size:"small",type:"info"},{default:t(()=>[d(o(f),1)]),_:2},1024))),128)),a.tags.length>2?(p(),g(x,{key:0,size:"small",type:"info"},{default:t(()=>[d(" +"+o(a.tags.length-2),1)]),_:2},1024)):P("",!0)])):P("",!0)])]}),_:1}),e(y,{prop:"lastUsedAt",label:"最后使用时间",width:"150"},{default:t(({row:a})=>[e(Z,{content:new Date(a.lastUsedAt).toLocaleString()},{default:t(()=>[i("span",null,o(s(oe)(a.lastUsedAt)),1)]),_:2},1032,["content"])]),_:1}),e(y,{prop:"rpm",label:"RPM",width:"120",sortable:""},{default:t(({row:a})=>[i("div",lt,[e(ee,{percentage:O(a.rpm),color:W(a.rpm),"stroke-width":6,"show-text":!1},null,8,["percentage","color"]),i("span",st,o(a.rpm),1)])]),_:1}),e(y,{prop:"currentGroup",label:"所属分组",width:"120"},{default:t(({row:a})=>[a.currentGroup?(p(),g(C,{key:0,type:"primary",size:"small"},{default:t(()=>[d(o(a.currentGroup.name),1)]),_:2},1024)):(p(),g(x,{key:1,type:"info",size:"small"},{default:t(()=>[...l[11]||(l[11]=[d("未分组",-1)])]),_:1}))]),_:1}),e(y,{prop:"usage.today.cost",label:"今日消费",width:"100",sortable:""},{default:t(({row:a})=>{var u,f,q,N;return[i("span",{class:Le(Q(((f=(u=a.usage)==null?void 0:u.today)==null?void 0:f.cost)||0))},o(s(V)(((N=(q=a.usage)==null?void 0:q.today)==null?void 0:N.cost)||0)),3)]}),_:1}),e(y,{prop:"usage.today.requests",label:"今日请求",width:"100",sortable:""},{default:t(({row:a})=>{var u,f;return[d(o(s(w)(((f=(u=a.usage)==null?void 0:u.today)==null?void 0:f.requests)||0)),1)]}),_:1}),e(y,{prop:"usage.today.totalTokens",label:"今日Token",width:"120",sortable:""},{default:t(({row:a})=>{var u,f;return[d(o(s(w)(((f=(u=a.usage)==null?void 0:u.today)==null?void 0:f.totalTokens)||0)),1)]}),_:1}),e(y,{prop:"isActive",label:"状态",width:"80"},{default:t(({row:a})=>[e(C,{type:a.isActive?"success":"danger",size:"small"},{default:t(()=>[d(o(a.isActive?"活跃":"非活跃"),1)]),_:2},1032,["type"])]),_:1}),e(y,{label:"操作",width:"150",fixed:"right"},{default:t(({row:a})=>[e(U,null,{default:t(()=>[e(I,{size:"small",onClick:Y(u=>z(a),["stop"])},{default:t(()=>[...l[12]||(l[12]=[d(" 详情 ",-1)])]),_:1},8,["onClick"]),e(I,{size:"small",onClick:Y(u=>J(a),["stop"])},{default:t(()=>[...l[13]||(l[13]=[d(" 趋势 ",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[le,s(m).loading]])]),_:1}),e(ae,{modelValue:K.value,"onUpdate:modelValue":l[3]||(l[3]=a=>K.value=a),title:`API Key: ${(M=r.value)==null?void 0:M.name}`,width:"800px"},{default:t(()=>[r.value?(p(),h("div",ot,[e(B,{gutter:16},{default:t(()=>[e(b,{span:12},{default:t(()=>[e(G,{title:"基本信息",column:1,border:""},{default:t(()=>[e(v,{label:"名称"},{default:t(()=>[d(o(r.value.name),1)]),_:1}),e(v,{label:"描述"},{default:t(()=>[d(o(r.value.description||"无"),1)]),_:1}),e(v,{label:"状态"},{default:t(()=>[e(C,{type:r.value.isActive?"success":"danger"},{default:t(()=>[d(o(r.value.isActive?"活跃":"非活跃"),1)]),_:1},8,["type"])]),_:1}),e(v,{label:"所属分组"},{default:t(()=>[r.value.currentGroup?(p(),g(C,{key:0,type:"primary"},{default:t(()=>[d(o(r.value.currentGroup.name),1)]),_:1})):(p(),h("span",nt,"未分组"))]),_:1}),e(v,{label:"最后使用"},{default:t(()=>[d(o(new Date(r.value.lastUsedAt).toLocaleString()),1)]),_:1})]),_:1})]),_:1}),e(b,{span:12},{default:t(()=>[e(G,{title:"使用统计",column:1,border:""},{default:t(()=>[e(v,{label:"RPM"},{default:t(()=>[d(o(r.value.rpm),1)]),_:1}),e(v,{label:"今日请求"},{default:t(()=>{var a,u;return[d(o(s(w)(((u=(a=r.value.usage)==null?void 0:a.today)==null?void 0:u.requests)||0)),1)]}),_:1}),e(v,{label:"今日Token"},{default:t(()=>{var a,u;return[d(o(s(w)(((u=(a=r.value.usage)==null?void 0:a.today)==null?void 0:u.totalTokens)||0)),1)]}),_:1}),e(v,{label:"今日费用"},{default:t(()=>{var a,u;return[d(o(s(V)(((u=(a=r.value.usage)==null?void 0:a.today)==null?void 0:u.cost)||0)),1)]}),_:1}),e(v,{label:"费用限制"},{default:t(()=>{var a;return[d(o((a=r.value.limits)!=null&&a.dailyCostLimit?s(V)(r.value.limits.dailyCostLimit):"无限制"),1)]}),_:1})]),_:1})]),_:1})]),_:1})])):P("",!0)]),_:1},8,["modelValue","title"])])}}}),Ct=se(it,[["__scopeId","data-v-d97074ac"]]);export{Ct as default};
//# sourceMappingURL=ApiKeysView-BGA4-qsD.js.map
