import{d as ae,a as se,b as le,r as U,c as oe,W as ue,o as ne,f as ie,g as d,X as de,h,s as u,i as e,w as t,k as s,j as _,U as N,V as q,Y as ce,C as re,Z as _e,v as o,n as pe,Q as fe,S as me,_ as ve,$ as he,z as g,B as K,x as i,y as ye,a0 as $,E as ge,F as Ce}from"./index.e61654b0.js";import{f as I,a as b,b as Ae}from"./format.8ff8c51b.js";import{_ as be}from"./_plugin-vue_export-helper.cdc0426e.js";const E=D=>(ge("data-v-6821a089"),D=D(),Ce(),D),Ee={class:"api-keys-view"},De={class:"header-actions"},ke={class:"filters"},we={class:"actions"},Fe=i(" \u5237\u65B0 "),Be=i(" \u5BFC\u51FA "),Ie={class:"stats-cards"},xe={class:"stat-card"},Ve={class:"stat-value"},Ue=E(()=>u("div",{class:"stat-label"},"\u6D3B\u8DC3API Keys",-1)),Ke={class:"stat-card"},Se={class:"stat-value"},Pe=E(()=>u("div",{class:"stat-label"},"\u4ECA\u65E5\u603B\u6D88\u8D39",-1)),Te={class:"stat-card"},ze={class:"stat-value"},Re=E(()=>u("div",{class:"stat-label"},"\u4ECA\u65E5\u603B\u8BF7\u6C42",-1)),Le={class:"stat-card"},Ge={class:"stat-value"},Me=E(()=>u("div",{class:"stat-label"},"\u5E73\u5747RPM",-1)),Ne={class:"card-header"},qe=E(()=>u("span",null,"API Key \u5217\u8868",-1)),$e={class:"el-text",type:"info",size:"small"},je={class:"api-key-name"},Qe={class:"el-text",strong:""},We={key:0,class:"tags"},Xe={key:0,class:"el-text",size:"small",type:"info"},Ye={key:1,class:"never-used"},Ze={class:"rpm-display"},He={class:"rpm-text"},Je={key:1,class:"el-text",type:"info",size:"small"},Oe=i(" \u8BE6\u60C5 "),et=i(" \u8D8B\u52BF "),tt={key:0,class:"api-key-details"},at={key:1},st=ae({setup(D){const f=se(),S=le(),r=U({groupId:"",isActive:!0,search:""}),x=U(!1),c=U(null),P=oe(()=>{let l=f.apiKeys;if(r.value.groupId&&(l=l.filter(n=>n.currentGroup?.id===r.value.groupId)),r.value.isActive!==void 0&&(l=l.filter(n=>n.isActive===r.value.isActive)),r.value.search){const n=r.value.search.toLowerCase();l=l.filter(p=>p.name.toLowerCase().includes(n)||p.description?.toLowerCase().includes(n)||p.keyId.toLowerCase().includes(n))}return l=[...l].sort((n,p)=>{if(!n.lastUsedAt&&!p.lastUsedAt)return 0;if(!n.lastUsedAt)return 1;if(!p.lastUsedAt)return-1;const k=new Date(n.lastUsedAt).getTime();return new Date(p.lastUsedAt).getTime()-k}),l}),V=()=>{f.updateApiKeyFilters({groupId:r.value.groupId||void 0,isActive:r.value.isActive,search:r.value.search||void 0})},j=ue(()=>{V()},500),T=async()=>{await f.fetchApiKeys()},Q=()=>{console.log("Export API Keys data")},z=l=>{c.value=l,x.value=!0,S.subscribeToApiKey(l.keyId)},W=l=>{console.log("Show usage chart for",l.name)},X=l=>Math.min(l/100*100,100),Y=l=>l<10?"#67c23a":l<50?"#e6a23c":"#f56c6c",Z=l=>l>50?"high-cost":l>20?"medium-cost":"low-cost";return ne(async()=>{await f.fetchGroups(),await T()}),ie(()=>{f.apiKeys.forEach(l=>{S.unsubscribe("apikey",l.keyId)})}),(l,n)=>{const p=d("el-option"),k=d("el-select"),R=d("el-input"),L=d("el-space"),w=d("el-button"),F=d("el-icon"),C=d("el-card"),y=d("el-col"),G=d("el-row"),A=d("el-tag"),v=d("el-table-column"),H=d("el-tooltip"),J=d("el-progress"),O=d("el-table"),m=d("el-descriptions-item"),M=d("el-descriptions"),ee=d("el-dialog"),te=de("loading");return _(),h("div",Ee,[u("div",De,[u("div",ke,[e(L,null,{default:t(()=>[e(k,{modelValue:r.value.groupId,"onUpdate:modelValue":n[0]||(n[0]=a=>r.value.groupId=a),placeholder:"\u9009\u62E9\u5206\u7EC4",clearable:"",onChange:V},{default:t(()=>[e(p,{label:"\u5168\u90E8\u5206\u7EC4",value:""}),(_(!0),h(N,null,q(s(f).groups,a=>(_(),g(p,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e(k,{modelValue:r.value.isActive,"onUpdate:modelValue":n[1]||(n[1]=a=>r.value.isActive=a),placeholder:"\u72B6\u6001",onChange:V},{default:t(()=>[e(p,{label:"\u5168\u90E8\u72B6\u6001",value:void 0}),e(p,{label:"\u6D3B\u8DC3",value:!0}),e(p,{label:"\u975E\u6D3B\u8DC3",value:!1})]),_:1},8,["modelValue"]),e(R,{modelValue:r.value.search,"onUpdate:modelValue":n[2]||(n[2]=a=>r.value.search=a),placeholder:"\u641C\u7D22API Key","prefix-icon":s(ce),clearable:"",onInput:s(j),style:{width:"200px"}},null,8,["modelValue","prefix-icon","onInput"])]),_:1})]),u("div",we,[e(w,{type:"primary",icon:s(re),loading:s(f).loading,onClick:T},{default:t(()=>[Fe]),_:1},8,["icon","loading"]),e(w,{icon:s(_e),onClick:Q},{default:t(()=>[Be]),_:1},8,["icon"])])]),u("div",Ie,[e(G,{gutter:16},{default:t(()=>[e(y,{span:6},{default:t(()=>[e(C,null,{default:t(()=>[u("div",xe,[u("div",Ve,o(s(f).activeApiKeys.length),1),Ue,e(F,{class:"stat-icon"},{default:t(()=>[e(s(pe))]),_:1})])]),_:1})]),_:1}),e(y,{span:6},{default:t(()=>[e(C,null,{default:t(()=>[u("div",Ke,[u("div",Se,o(s(I)(s(f).totalDailyCost)),1),Pe,e(F,{class:"stat-icon"},{default:t(()=>[e(s(fe))]),_:1})])]),_:1})]),_:1}),e(y,{span:6},{default:t(()=>[e(C,null,{default:t(()=>[u("div",Te,[u("div",ze,o(s(b)(s(f).totalTodayRequests)),1),Re,e(F,{class:"stat-icon"},{default:t(()=>[e(s(me))]),_:1})])]),_:1})]),_:1}),e(y,{span:6},{default:t(()=>[e(C,null,{default:t(()=>[u("div",Le,[u("div",Ge,o(s(f).averageRPM),1),Me,e(F,{class:"stat-icon"},{default:t(()=>[e(s(ve))]),_:1})])]),_:1})]),_:1})]),_:1})]),e(C,null,{header:t(()=>[u("div",Ne,[qe,u("span",$e," \u5171 "+o(s(P).length)+" \u4E2AAPI Key ",1)])]),default:t(()=>[he((_(),g(O,{data:s(P),stripe:"",style:{width:"100%"},flexible:!0,onRowClick:z},{default:t(()=>[e(v,{prop:"name",label:"API Key\u540D\u79F0","min-width":"200"},{default:t(({row:a})=>[u("div",je,[u("span",Qe,o(a.name),1),a.tags?.length?(_(),h("div",We,[(_(!0),h(N,null,q(a.tags.slice(0,2),B=>(_(),g(A,{key:B,size:"small",type:"info"},{default:t(()=>[i(o(B),1)]),_:2},1024))),128)),a.tags.length>2?(_(),h("span",Xe," +"+o(a.tags.length-2),1)):K("",!0)])):K("",!0)])]),_:1}),e(v,{prop:"lastUsedAt",label:"\u6700\u540E\u4F7F\u7528\u65F6\u95F4","min-width":"150",sortable:""},{default:t(({row:a})=>[a.lastUsedAt?(_(),g(H,{key:0,content:new Date(a.lastUsedAt).toLocaleString()},{default:t(()=>[u("span",null,o(s(Ae)(a.lastUsedAt)),1)]),_:2},1032,["content"])):(_(),h("span",Ye,"\u4ECE\u672A\u4F7F\u7528"))]),_:1}),e(v,{prop:"rpm",label:"RPM",width:"100",sortable:""},{default:t(({row:a})=>[u("div",Ze,[e(J,{percentage:X(a.rpm),color:Y(a.rpm),"stroke-width":6,"show-text":!1},null,8,["percentage","color"]),u("span",He,o(a.rpm),1)])]),_:1}),e(v,{prop:"currentGroup",label:"\u6240\u5C5E\u5206\u7EC4","min-width":"120"},{default:t(({row:a})=>[a.currentGroup?(_(),g(A,{key:0,type:"primary",size:"small"},{default:t(()=>[i(o(a.currentGroup.name),1)]),_:2},1024)):(_(),h("span",Je,"\u672A\u5206\u7EC4"))]),_:1}),e(v,{prop:"usage.today.cost",label:"\u4ECA\u65E5\u6D88\u8D39",width:"110",sortable:""},{default:t(({row:a})=>[u("span",{class:ye(Z(a.usage?.today?.cost||0))},o(s(I)(a.usage?.today?.cost||0)),3)]),_:1}),e(v,{prop:"usage.today.requests",label:"\u4ECA\u65E5\u8BF7\u6C42",width:"110",sortable:""},{default:t(({row:a})=>[i(o(s(b)(a.usage?.today?.requests||0)),1)]),_:1}),e(v,{prop:"usage.today.totalTokens",label:"\u4ECA\u65E5Token","min-width":"130",sortable:""},{default:t(({row:a})=>[i(o(s(b)(a.usage?.today?.totalTokens||0)),1)]),_:1}),e(v,{prop:"isActive",label:"\u72B6\u6001",width:"90",align:"center"},{default:t(({row:a})=>[e(A,{type:a.isActive?"success":"danger",size:"small"},{default:t(()=>[i(o(a.isActive?"\u6D3B\u8DC3":"\u975E\u6D3B\u8DC3"),1)]),_:2},1032,["type"])]),_:1}),e(v,{label:"\u64CD\u4F5C","min-width":"140",fixed:"right"},{default:t(({row:a})=>[e(L,null,{default:t(()=>[e(w,{size:"small",onClick:$(B=>z(a),["stop"])},{default:t(()=>[Oe]),_:2},1032,["onClick"]),e(w,{size:"small",onClick:$(B=>W(a),["stop"])},{default:t(()=>[et]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[te,s(f).loading]])]),_:1}),e(ee,{modelValue:x.value,"onUpdate:modelValue":n[3]||(n[3]=a=>x.value=a),title:`API Key: ${c.value?.name}`,width:"800px"},{default:t(()=>[c.value?(_(),h("div",tt,[e(G,{gutter:16},{default:t(()=>[e(y,{span:12},{default:t(()=>[e(M,{title:"\u57FA\u672C\u4FE1\u606F",column:1,border:""},{default:t(()=>[e(m,{label:"\u540D\u79F0"},{default:t(()=>[i(o(c.value.name),1)]),_:1}),e(m,{label:"\u63CF\u8FF0"},{default:t(()=>[i(o(c.value.description||"\u65E0"),1)]),_:1}),e(m,{label:"\u72B6\u6001"},{default:t(()=>[e(A,{type:c.value.isActive?"success":"danger"},{default:t(()=>[i(o(c.value.isActive?"\u6D3B\u8DC3":"\u975E\u6D3B\u8DC3"),1)]),_:1},8,["type"])]),_:1}),e(m,{label:"\u6240\u5C5E\u5206\u7EC4"},{default:t(()=>[c.value.currentGroup?(_(),g(A,{key:0,type:"primary"},{default:t(()=>[i(o(c.value.currentGroup.name),1)]),_:1})):(_(),h("span",at,"\u672A\u5206\u7EC4"))]),_:1}),e(m,{label:"\u6700\u540E\u4F7F\u7528"},{default:t(()=>[i(o(new Date(c.value.lastUsedAt).toLocaleString()),1)]),_:1})]),_:1})]),_:1}),e(y,{span:12},{default:t(()=>[e(M,{title:"\u4F7F\u7528\u7EDF\u8BA1",column:1,border:""},{default:t(()=>[e(m,{label:"RPM"},{default:t(()=>[i(o(c.value.rpm),1)]),_:1}),e(m,{label:"\u4ECA\u65E5\u8BF7\u6C42"},{default:t(()=>[i(o(s(b)(c.value.usage?.today?.requests||0)),1)]),_:1}),e(m,{label:"\u4ECA\u65E5Token"},{default:t(()=>[i(o(s(b)(c.value.usage?.today?.totalTokens||0)),1)]),_:1}),e(m,{label:"\u4ECA\u65E5\u8D39\u7528"},{default:t(()=>[i(o(s(I)(c.value.usage?.today?.cost||0)),1)]),_:1}),e(m,{label:"\u8D39\u7528\u9650\u5236"},{default:t(()=>[i(o(c.value.limits?.dailyCostLimit?s(I)(c.value.limits.dailyCostLimit):"\u65E0\u9650\u5236"),1)]),_:1})]),_:1})]),_:1})]),_:1})])):K("",!0)]),_:1},8,["modelValue","title"])])}}});const nt=be(st,[["__scopeId","data-v-6821a089"]]);export{nt as default};
