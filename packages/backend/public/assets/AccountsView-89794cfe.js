import{q as le,c as ne,o as ce,d as m,e as a,D as e,v as t,K as c,V as ie,b as i,F as de,N as re,x as ue,t as g,B as r,H as _e,A,z as pe,a5 as me,a6 as fe}from"./vue-vendor-b6cd13bd.js";import{$ as C,u,ak as ve,ae as ge,ad as o,ab as he,an as S,a6 as be}from"./element-plus-7892819a.js";import{u as ye,a as ke}from"./index-4886d59f.js";import{a as F,f as O,b as q}from"./format-96392f60.js";import{_ as xe}from"./_plugin-vue_export-helper-c27b6911.js";import"./utils-e3271d43.js";const v=k=>(me("data-v-5a86fe94"),k=k(),fe(),k),we={class:"accounts-view"},Ae={class:"accounts-grid"},Ce={class:"account-header"},Ve={class:"account-info"},Me={class:"account-name"},Te={class:"account-metrics"},Re={class:"metric"},Ne=v(()=>a("span",{class:"metric-label"},"今日Token:",-1)),Se={class:"metric-value"},De={class:"metric"},Ue=v(()=>a("span",{class:"metric-label"},"今日费用:",-1)),Ie={class:"metric-value expense"},ze={class:"metric"},Pe=v(()=>a("span",{class:"metric-label"},"近10分钟RPM:",-1)),Be={class:"metric-value"},Le={key:0,class:"group-info"},Ee={class:"group-details"},$e={class:"group-name"},Fe={class:"group-stats"},Oe={class:"group-stat"},qe={class:"group-stat"},Ge={class:"last-used"},He={class:"el-text",type:"info",size:"small"},Ke={class:"card-header"},Qe=v(()=>a("span",null,"账号详细统计",-1)),je={class:"header-actions"},Je=r(" 刷新 "),We={class:"account-name-cell"},Xe={class:"el-text",strong:""},Ye={class:"token-usage"},Ze={class:"expense"},et={class:"rpm-cell"},tt={class:"rpm-value"},st={key:1,class:"no-group"},at={key:0},ot={key:1},lt={key:0,class:"active-users"},nt={key:1},ct=r(" 详情 "),it={key:0,class:"account-details"},dt={key:1},rt={class:"stat-item"},ut=v(()=>a("div",{class:"stat-title"},"今日Token使用量",-1)),_t={class:"stat-value"},pt={class:"stat-item"},mt=v(()=>a("div",{class:"stat-title"},"今日费用消耗",-1)),ft={class:"stat-value"},vt={class:"stat-item"},gt=v(()=>a("div",{class:"stat-title"},"近10分钟平均RPM",-1)),ht={class:"stat-value"},bt=v(()=>a("div",{class:"usage-charts",style:{"margin-top":"20px"}},[a("span",{class:"el-text",type:"info"},"使用趋势图表功能开发中...")],-1)),yt=le({setup(k){const b=ye(),G=ke(),x=C(""),w=C(""),V=C(!1),n=C(null),H=ne(()=>{let l=b.accounts;if(x.value){const d=x.value.toLowerCase();l=l.filter(_=>_.accountName.toLowerCase().includes(d)||_.accountId.toLowerCase().includes(d))}return w.value&&(l=l.filter(d=>d.platform===w.value)),l}),D=async()=>{await b.fetchAccounts()},M=l=>{n.value=l,V.value=!0,G.subscribeToAccount(l.accountId)},K=l=>{switch(l){case"claude-console":case"claude":return S;case"gemini":return S;case"openai":return be;default:return S}},U=l=>({"claude-console":"Claude Console",claude:"Claude",gemini:"Gemini",openai:"OpenAI",bedrock:"Bedrock","azure-openai":"Azure OpenAI"})[l]||l,I=l=>({"claude-console":"primary",claude:"success",gemini:"warning",openai:"info"})[l]||"info",T=l=>({active:"活跃",expired:"已过期",error:"错误",created:"已创建"})[l]||l,R=l=>({active:"success",expired:"warning",error:"danger",created:"info"})[l]||"info",Q=l=>Math.min(l/100*100,100),j=l=>l<20?"#67c23a":l<60?"#e6a23c":"#f56c6c";return ce(()=>{D()}),(l,d)=>{var $;const _=c("el-tag"),z=c("el-icon"),J=c("el-divider"),P=c("el-card"),h=c("el-col"),N=c("el-row"),W=c("el-input"),y=c("el-option"),X=c("el-select"),B=c("el-button"),p=c("el-table-column"),Y=c("el-progress"),Z=c("el-tooltip"),ee=c("el-table"),f=c("el-descriptions-item"),L=c("el-descriptions"),E=c("el-tab-pane"),te=c("el-tabs"),se=c("el-dialog"),ae=ie("loading");return i(),m("div",we,[a("div",Ae,[e(N,{gutter:16},{default:t(()=>[(i(!0),m(de,null,re(u(b).accounts.slice(0,4),s=>(i(),g(h,{span:6,key:s.accountId},{default:t(()=>[e(P,{class:"account-card",onClick:oe=>M(s)},{default:t(()=>[a("div",Ce,[a("div",Ve,[a("h3",Me,o(s.accountName),1),e(_,{type:R(s.status),size:"small"},{default:t(()=>[r(o(T(s.status)),1)]),_:2},1032,["type"])]),e(z,{class:"account-icon"},{default:t(()=>[(i(),g(pe(K(s.platform))))]),_:2},1024)]),a("div",Te,[a("div",Re,[Ne,a("span",Se,o(u(F)(s.todayTokenUsage)),1)]),a("div",De,[Ue,a("span",Ie,o(u(O)(s.todayExpense)),1)]),a("div",ze,[Pe,a("span",Be,o(s.recentAvgRpm),1)])]),s.group?(i(),m("div",Le,[e(J),a("div",Ee,[a("div",$e,[e(z,null,{default:t(()=>[e(u(he))]),_:1}),a("span",null,o(s.group.name),1)]),a("div",Fe,[a("span",Oe," 总用户: "+o(s.group.totalMembers),1),a("span",qe," 活跃: "+o(s.group.activeMembers),1)])])])):A("",!0),a("div",Ge,[a("span",He," 最后使用: "+o(u(q)(s.lastUsedAt)),1)])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})]),e(P,null,{header:t(()=>[a("div",Ke,[Qe,a("div",je,[e(W,{modelValue:x.value,"onUpdate:modelValue":d[0]||(d[0]=s=>x.value=s),placeholder:"搜索账号","prefix-icon":u(ve),clearable:"",style:{width:"200px","margin-right":"8px"}},null,8,["modelValue","prefix-icon"]),e(X,{modelValue:w.value,"onUpdate:modelValue":d[1]||(d[1]=s=>w.value=s),placeholder:"选择平台",clearable:"",style:{width:"150px","margin-right":"8px"}},{default:t(()=>[e(y,{label:"全部平台",value:""}),e(y,{label:"Claude Console",value:"claude-console"}),e(y,{label:"Claude",value:"claude"}),e(y,{label:"Gemini",value:"gemini"}),e(y,{label:"OpenAI",value:"openai"})]),_:1},8,["modelValue"]),e(B,{type:"primary",icon:u(ge),loading:u(b).loading,onClick:D},{default:t(()=>[Je]),_:1},8,["icon","loading"])])])]),default:t(()=>[ue((i(),g(ee,{data:u(H),stripe:"",style:{width:"100%"},flexible:!0,onRowClick:M},{default:t(()=>[e(p,{prop:"accountName",label:"账号名称","min-width":"150"},{default:t(({row:s})=>[a("div",We,[a("span",Xe,o(s.accountName),1),e(_,{type:I(s.platform),size:"small"},{default:t(()=>[r(o(U(s.platform)),1)]),_:2},1032,["type"])])]),_:1}),e(p,{prop:"todayTokenUsage",label:"今日Token使用量","min-width":"140",sortable:""},{default:t(({row:s})=>[a("span",Ye,o(u(F)(s.todayTokenUsage)),1)]),_:1}),e(p,{prop:"todayExpense",label:"今日费用消耗","min-width":"130",sortable:""},{default:t(({row:s})=>[a("span",Ze,o(u(O)(s.todayExpense)),1)]),_:1}),e(p,{prop:"recentAvgRpm",label:"近10分钟RPM","min-width":"120",sortable:""},{default:t(({row:s})=>[a("div",et,[e(Y,{percentage:Q(s.recentAvgRpm),"stroke-width":6,"show-text":!1,color:j(s.recentAvgRpm)},null,8,["percentage","color"]),a("span",tt,o(s.recentAvgRpm),1)])]),_:1}),e(p,{prop:"group",label:"账号所属分组","min-width":"130"},{default:t(({row:s})=>[s.group?(i(),g(_,{key:0,type:"primary",size:"small"},{default:t(()=>[r(o(s.group.name),1)]),_:2},1024)):(i(),m("span",st,"无分组"))]),_:1}),e(p,{prop:"group.totalMembers",label:"分组用户数",width:"110"},{default:t(({row:s})=>[s.group?(i(),m("span",at,o(s.group.totalMembers),1)):(i(),m("span",ot,"-"))]),_:1}),e(p,{prop:"group.activeMembers",label:"分组活跃用户","min-width":"130"},{default:t(({row:s})=>[s.group?(i(),m("span",lt,o(s.group.activeMembers)+"/"+o(s.group.totalMembers),1)):(i(),m("span",nt,"-"))]),_:1}),e(p,{prop:"status",label:"状态",width:"90",align:"center"},{default:t(({row:s})=>[e(_,{type:R(s.status),size:"small"},{default:t(()=>[r(o(T(s.status)),1)]),_:2},1032,["type"])]),_:1}),e(p,{prop:"lastUsedAt",label:"最后使用时间","min-width":"150"},{default:t(({row:s})=>[e(Z,{content:new Date(s.lastUsedAt).toLocaleString()},{default:t(()=>[a("span",null,o(u(q)(s.lastUsedAt)),1)]),_:2},1032,["content"])]),_:1}),e(p,{label:"操作","min-width":"120",fixed:"right"},{default:t(({row:s})=>[e(B,{size:"small",onClick:_e(oe=>M(s),["stop"])},{default:t(()=>[ct]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[ae,u(b).loading]])]),_:1}),e(se,{modelValue:V.value,"onUpdate:modelValue":d[2]||(d[2]=s=>V.value=s),title:`账号详情: ${($=n.value)==null?void 0:$.accountName}`,width:"1000px"},{default:t(()=>[n.value?(i(),m("div",it,[e(te,null,{default:t(()=>[e(E,{label:"基本信息",name:"basic"},{default:t(()=>[e(N,{gutter:16},{default:t(()=>[e(h,{span:12},{default:t(()=>[e(L,{title:"账号信息",column:1,border:""},{default:t(()=>[e(f,{label:"账号名称"},{default:t(()=>[r(o(n.value.accountName),1)]),_:1}),e(f,{label:"平台"},{default:t(()=>[e(_,{type:I(n.value.platform)},{default:t(()=>[r(o(U(n.value.platform)),1)]),_:1},8,["type"])]),_:1}),e(f,{label:"状态"},{default:t(()=>[e(_,{type:R(n.value.status)},{default:t(()=>[r(o(T(n.value.status)),1)]),_:1},8,["type"])]),_:1}),e(f,{label:"是否活跃"},{default:t(()=>[e(_,{type:n.value.isActive?"success":"danger"},{default:t(()=>[r(o(n.value.isActive?"是":"否"),1)]),_:1},8,["type"])]),_:1}),e(f,{label:"最后使用时间"},{default:t(()=>[r(o(new Date(n.value.lastUsedAt).toLocaleString()),1)]),_:1})]),_:1})]),_:1}),e(h,{span:12},{default:t(()=>[e(L,{title:"分组信息",column:1,border:""},{default:t(()=>[e(f,{label:"所属分组"},{default:t(()=>[n.value.group?(i(),g(_,{key:0,type:"primary"},{default:t(()=>[r(o(n.value.group.name),1)]),_:1})):(i(),m("span",dt,"无分组"))]),_:1}),n.value.group?(i(),g(f,{key:0,label:"分组总用户数"},{default:t(()=>[r(o(n.value.group.totalMembers),1)]),_:1})):A("",!0),n.value.group?(i(),g(f,{key:1,label:"分组活跃用户数"},{default:t(()=>[r(o(n.value.group.activeMembers),1)]),_:1})):A("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),e(E,{label:"使用统计",name:"usage"},{default:t(()=>[e(N,{gutter:16},{default:t(()=>[e(h,{span:8},{default:t(()=>[a("div",rt,[ut,a("div",_t,o(n.value.todayTokenUsage||0),1)])]),_:1}),e(h,{span:8},{default:t(()=>[a("div",pt,[mt,a("div",ft,"$"+o((n.value.todayExpense||0).toFixed(2)),1)])]),_:1}),e(h,{span:8},{default:t(()=>[a("div",vt,[gt,a("div",ht,o(n.value.recentAvgRpm||0),1)])]),_:1})]),_:1}),bt]),_:1})]),_:1})])):A("",!0)]),_:1},8,["modelValue","title"])])}}});const Mt=xe(yt,[["__scopeId","data-v-5a86fe94"]]);export{Mt as default};
